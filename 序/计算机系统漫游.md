# 计算机系统漫游

计算机系统 = 硬件 + 软件系统

```c
#include <stdio.h>

int main(void)
{
    printf("hello world\n");

    return 0;
}
```

## 信息就是位 + 上下文

系统中的所有信息--包括磁盘文件、内存中的程序、网络上传输的数据，都是由一串比特表示的

区分不同数据的唯一方法是时读到这些数据时的上下文。（int float ...）
一个同样的字节序列可能代表不同的意义

应该了解数字的机器表示方式

## 程序被其他程序翻译成不同格式

c语句 --> 机器语言指令 --> 按照可执行目标程序格式打包并以二进制磁盘文件的形式存放 -->   可执行目标文件

在 Unix 系统上 ，从源文件到目标文件的转化是由编译器驱动程序完成的
```bash
gcc -o hello.c
```

这个翻译过程分为四个阶段

![](image/2020-06-16-22-09-58.png)
执行这四个阶段的程序（预处理器，编译器，汇编器，连接器）构成了编译系统

+ 预处理阶段： 处理 ‘#’
+ 编译阶段： 转汇编
+ 汇编阶段： 转机器语言
+ 链接阶段： 整合其它文件

## 了解编译器如何工作是大有益处的

溢出：

+ 优化程序性能
+ 理解链接时出现的错误
+ 避免安全漏洞

## 处理器读并解释存在内存中的指令

可以执行那个可执行文件
```bash
./hello.o
```

### 系统的硬件组成

![](image/2020-06-16-22-21-46.png)

**1、总线**

总线是一组电子管道，负责携带、传递信息字节。它通常被设计成传递定长的字节块，也就是字（word）。字中的字节数（字长）是一个基本的系统参数，大多为4个字节（32位）或者8个字节（64位）。

**2、I/O设备**

输入输出设备（键盘 磁盘 显示器 ...）
每个I/O 设备都通过一个控制器或适配器与I/O总线相连。

控制器是I/O设备本身或者系统的主印制电路板（主板）上的芯片组

适配器是一块在主板插槽上的卡

它们的功能都是在I/O总线和I/O设备之间传递信息

**3、主存**

主存是一个临时存储设备，在处理器执行程序时，用来存放程序和程序处理的数据。

从物理上说，主存是由一组动态随机存取存储器(DRAM)芯片组成的。

从逻辑上说，存储器是一个线性的字节数组，每个字节都有其唯一的地址（数组索引），这些地址是从零开始的。

**4、处理器**

中央处理单元（CPU）,简称处理器，是解释（或执行）存储在主存中指令的引擎。

处理器的核心是一个大小为一个字的存储设备（寄存器），称为程序计数器(PC)。在任何时刻，PC都指向主存中的某条机器语言指令（即含有该条指令的地址 ）。

从系统通电开始，直到系统断电，处理器一直在不断地执行程序计数器指向的指令， 再更新程序计数器，使其指向下一条指令。处理器看上去是按照一个非常简单的指令执行 模型来操作的，这个模型是由指令集架构决定的。在这个模型中，指令按照严格的顺序执 行，而执行一条指令包含执行一系列的步骤。处理器从程序计数器指向的内存处读取指令，解释指令中的位，执行该指令指示的简单操作，然后更新PC,使其指向下一条指令， 而这条指令并不一定和在内存中刚刚执行的指令相邻。

这样的简单操作并不多，它们围绕着主存、寄存器文件(register file)和算未/逻辑单 元(ALU)进行。寄存器文件是一个小的存储设备，由一些单个字长的寄存器组成，每个 寄存器都有唯一的名字。ALU计算新的数据和地址值。下面是一些简单操作的例子, CPU在指令的要求下可能会执行这些操作。

处理器看上去是它的指令集架构的简单实现，但是实际上现代处理器使用了非常复杂 的机制来加速程序的执行。因此，我们将处理器的指令集架构和处理器的微体系结构区分 开来：指令集架构描述的是每条机器代码指令的效果；而微体系结构描述的是处理器实际 上是如何实现的。

### 运行hello程序

1、shell接收指令，加载可执行文件，将其从磁盘复制到主存（DMA技术）

2、处理器开始执行程序中的机器指令，将‘hello，world\n'字节从主存复制到寄存器文件，再从寄存器文件复制到显示设备，完成显示
![](image/2020-06-16-22-58-52.png)
![](image/2020-06-16-22-59-04.png)
![](image/2020-06-16-22-59-13.png)

